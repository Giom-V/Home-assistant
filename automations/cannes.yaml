# Automations related to our apartment in Cannes.
#
# There are 2 automations:
# * `Cannes: Someone using the lights`: Notifies us if the lights are being used
#   while we are not there.
# * `Porte placard privé Cannes ouverte`: Notifies us if the private closet door
#   is opened while we are not there.

- id: "cannes_lights_on_when_absent"
  alias: "Cannes: Someone using the lights"
  description: "Notifies us if the lights in Cannes are turned on when we are not there."
  trigger:
    - platform: state
      entity_id:
        - light.cannes_lumiere_cuisine
        - light.cannes_lumiere_salle_a_manger
  conditions:
    - condition: not
      conditions:
        - condition: or
          conditions:
            - condition: zone
              entity_id: person.claire
              zone: zone.cannes
            - condition: zone
              entity_id: person.guillaume
              zone: zone.cannes
            - condition: zone
              entity_id: person.pascal
              zone: zone.cannes
      enabled: true
  actions:
    - service: rest_command.gchat
      data:
        text: Un locataire est en train de jouer avec les lumières de Cannes.
    - service: notify.mobile_app_pixel_9_xl
      data:
        message: Un locataire est en train de jouer avec les lumières de Cannes.
        title: Cannes
    - service: notify.mobile_app_pixel_7q_pascal
      data:
        message: Un locataire est en train de jouer avec les lumières de Cannes.
        title: Cannes
    - service: notify.mobile_app_pixel_8a_jacqueline
      data:
        message: Un locataire est en train de jouer avec les lumières de Cannes.
        title: Cannes
  mode: single
- id: "cannes_private_closet_opened"
  alias: Porte placard privé Cannes ouverte
  description: "Notifies us if the private closet door in Cannes is opened when we are not there."
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.placard_prive_door
      to: "on"
  conditions:
    - condition: not
      conditions:
        - condition: or
          conditions:
            - condition: zone
              entity_id: person.claire
              zone: zone.cannes
            - condition: zone
              entity_id: person.guillaume
              zone: zone.cannes
            - condition: zone
              entity_id: person.pascal
              zone: zone.cannes
      enabled: true
  actions:
    - service: notify.mobile_app_pixel_9_pro_xl
      data:
        message: Porte placard Cannes ouverte !
        title: Cannes
    - service: notify.mobile_app_pixel_7a_pascal
      data:
        message: Porte placard Cannes ouverte !
        title: Cannes
    - service: notify.mobile_app_pixel_8a_jacqueline
      data:
        message: Porte placard Cannes ouverte !
        title: Cannes
    - service: notify.notify
      data:
        message: Porte placard Cannes ouverte !
        title: Cannes
      enabled: false
    - service: rest_command.gchat
      data:
        text: Un locataire a ouvert le placard de Cannes.
  mode: single
