- id: "1678555471570"
  alias: Extinction des feux
  description: "Éteint toutes les lumières et appareils à 23h"
  trigger:
    - platform: time
      at: "23:00:00"
  condition: []
  action:
    - type: turn_off
      entity_id: light.lumiere_exterieure_1_forceonlight
      domain: light
    - type: turn_off
      entity_id: light.lampe_exterieure_2
      domain: light
    - type: turn_off
      entity_id: light.lampe_exterieure_3
      domain: light
    - service: select.select_option
      data:
        option: "Off"
      target:
        entity_id: select.aurores_light_bulb_start_up_behavior
    - type: turn_off
      device_id: cef49caed9c762db670b6d2a85a15832
      entity_id: switch.aurore_bed_light_switch
      domain: switch
    - type: turn_off
      device_id: d437e500bc37e2cbd9119d9ae51214bf
      entity_id: switch.hdr_monitor
      domain: switch
    - type: turn_off
      device_id: d437e500bc37e2cbd9119d9ae51214bf
      entity_id: switch.vertical_monitor
      domain: switch
    - type: turn_off
      device_id: 93b4f42fad374b6536e6a0602f1708b0
      entity_id: 0f22d93bb08479d66e2679f5bb3cd0aa
      domain: switch
  mode: single
- id: "1707984261282"
  alias: Close covers at sunset
  description: "Ferme les volets au coucher du soleil"
  triggers:
    - event: sunset
      offset: 15
      trigger: sun
  conditions:
    - condition: numeric_state
      entity_id: sensor.temperature_exterieure_solisart
      below: 10
  actions:
    - device_id: dfe890255b2aec25d04652bf3f562bcb
      domain: cover
      entity_id: 9d96788bbf491daa38a43974d3af81fd
      type: close
    - device_id: 8f16b93c4fae1055fc21ef57afca5b0f
      domain: cover
      entity_id: 5159b1462f01722c359983c04fea0e28
      type: close
    - if:
        - condition: state
          entity_id: binary_sensor.velux_bureau_contact
          state: "off"
      then:
        - device_id: 733eb70641efac866005440f0d764623
          domain: cover
          entity_id: ad9bb28acca59679697828aaba529647
          type: close
    - action: cover.close_cover
      metadata: {}
      data: {}
      target:
        entity_id: cover.volets_chambre
    - if:
        - condition: state
          entity_id: input_boolean.away_mode
          state: "on"
          for:
            hours: 24
            minutes: 0
            seconds: 0
      then:
        - action: cover.close_cover
          metadata: {}
          data: {}
          target:
            entity_id:
              - cover.volets_salle_de_jeux
              - cover.legrand_shutter_sw_with_level_control_cover
              - cover.volets_cuisine
  mode: single
- id: "1737370119461"
  alias: Open covers when it's sunny
  description: "Ouvre les volets quand il y a du soleil"
  triggers:
    - trigger: numeric_state
      entity_id:
        - sensor.efficacite_panneaux_solaires
      above: 0
  conditions:
    - condition: numeric_state
      entity_id: sensor.temperature_exterieure_solisart
      below: 10
  actions:
    - action: script.turn_on
      metadata: {}
      data: {}
      target:
        entity_id: script.open_all_first_floor_shutters
    - if:
        - condition: or
          conditions:
            - condition: state
              entity_id: input_boolean.visitors
              state: "on"
            - condition: not
              conditions:
                - condition: state
                  entity_id: binary_sensor.people_home
                  state: "off"
                  for:
                    hours: 0
                    minutes: 30
                    seconds: 0
      then:
        - action: cover.open_cover
          metadata: {}
          data: {}
          target:
            device_id:
              - 3f356462bb4d8107cea10c05f3c0637e
              - 98ca57dc34f30913565109817baf591f
  mode: single
- id: "1687949528073"
  alias: Close water if a leak is detected
  description: "Coupe l'eau si une fuite est détectée"
  trigger:
    - type: moist
      platform: device
      device_id: dd451c8daffe059f22ccc2209342cbc2
      entity_id: binary_sensor.flood_detector_basement_flood
      domain: binary_sensor
  condition: []
  action:
    - type: turn_off
      device_id: 95c85383ea986cdfab0a3fe9c33f7a49
      entity_id: light.vanne_light
      domain: light
  mode: single
- id: "1688126732710"
  alias: "Sécurité: couper l'eau si une fuite est détectée (pour l'instant dans
    le jardin)"
  description: "Sécurité: coupe l'eau si une fuite est détectée (jardin)"
  trigger:
    - type: humidity
      platform: device
      device_id: cad5fd413dbabbb36bdee8579c03dab8
      entity_id: sensor.potager_soil_moisture
      domain: sensor
      above: 95
      for:
        hours: 0
        minutes: 15
        seconds: 0
  condition:
    - condition: state
      entity_id: binary_sensor.people_home
      state: "off"
  action:
    - type: turn_off
      device_id: 95c85383ea986cdfab0a3fe9c33f7a49
      entity_id: light.vanne_light
      domain: light
  mode: single
- id: "1688200212515"
  alias: Basement stairs light when motion detected
  description: "Allume la lumière de l'escalier du sous-sol lors de la détection de mouvement"
  trigger:
    - type: motion
      platform: device
      device_id: 9c37dc10f4cbe78c564574ef700d2689
      entity_id: binary_sensor.motion_sensor_basement_stairs_motion
      domain: binary_sensor
  condition: []
  action:
    - type: turn_on
      device_id: 697f0a9d8354bee483e0058a6e8b5410
      entity_id: light.basement_stairs_light_light
      domain: light
    - wait_for_trigger:
        - type: no_motion
          platform: device
          device_id: 9c37dc10f4cbe78c564574ef700d2689
          entity_id: 2247856e02bf3556557c139acc6bb72e
          domain: binary_sensor
          for:
            hours: 0
            minutes: 1
            seconds: 0
      enabled: true
    - type: turn_off
      device_id: 697f0a9d8354bee483e0058a6e8b5410
      entity_id: ad28d0c88258e744ab5a720291522f3b
      domain: light
      enabled: true
    - delay:
        hours: 0
        minutes: 0
        seconds: 15
        milliseconds: 0
  mode: single
- id: "1688200466384"
  alias: Basement stairs lights off when motion stopped
  description: "Éteint la lumière de l'escalier du sous-sol lorsque le mouvement s'arrête"
  trigger:
    - type: no_motion
      platform: device
      device_id: 9c37dc10f4cbe78c564574ef700d2689
      entity_id: binary_sensor.motion_sensor_basement_stairs_motion
      domain: binary_sensor
      for:
        hours: 0
        minutes: 1
        seconds: 0
  condition: []
  action:
    - type: turn_off
      device_id: 697f0a9d8354bee483e0058a6e8b5410
      entity_id: ad28d0c88258e744ab5a720291522f3b
      domain: light
  mode: restart
- id: "1689543800532"
  alias: Flood detected
  description: "Notifie quand une inondation est détectée"
  trigger:
    - type: moist
      platform: device
      device_id: 2a230f2371c0d65ab5cc143dbd0b7df3
      entity_id: 4b6d3f99a99a0d92c0de91ac66d99384
      domain: binary_sensor
      id: flood_in_kitchen
    - type: moist
      platform: device
      device_id: dd451c8daffe059f22ccc2209342cbc2
      entity_id: 915a11f853df87ec87528861360129e7
      domain: binary_sensor
      id: flood_in_basement
  condition: []
  action:
    - choose:
        - conditions:
            - condition: trigger
              id:
                - flood_in_kitchen
          sequence:
            - service: rest_command.gchatalert
              data:
                text: Fuite dans la cuisine !
        - conditions:
            - condition: trigger
              id:
                - flood_in_basement
          sequence:
            - service: rest_command.gchatalert
              data:
                text: Fuite dans le sous-sol !
    - type: turn_off
      device_id: 95c85383ea986cdfab0a3fe9c33f7a49
      entity_id: light.vanne_light
      domain: light
  mode: single
- id: "1697917560752"
  alias: "Fuite au sous-sol "
  description: "Détecte une fuite au sous-sol"
  trigger:
    - type: moist
      platform: device
      device_id: 1182ddc99c6d86a6f5f82b0e05170b3f
      entity_id: 5cff1292faeb8ba8417017b5a3440c65
      domain: binary_sensor
      for:
        hours: 0
        minutes: 2
        seconds: 0
    - type: moist
      platform: device
      device_id: 2904f86b89a60a20afcf47e53bec80a8
      entity_id: 2c5888e5f268ec1d2ffc9720e0eb5849
      domain: binary_sensor
      for:
        hours: 0
        minutes: 2
        seconds: 0
  condition: []
  action:
    - service: rest_command.gchatalert
      data:
        text: Fuite au sous-sol !!!
    - service: tts.google_say
      entity_id: all
      data:
        message: Fuite détectée !
    - service: notify.mobile_app_pixel_7_pro
      data:
        message: "Fuite détectée "
        title: Fuite
  mode: single
- id: "1703071835981"
  alias: Conso heures pleines/creuses
  description: "Gère la consommation en heures pleines/creuses"
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.heure_creuse
  condition: []
  action:
    - if:
        - condition: state
          entity_id: binary_sensor.heure_creuse
          state: "on"
      then:
        - device_id: 1a214649b9b77e47ee787c2109d1e2e2
          domain: select
          entity_id: 476a709158fbee446d7c0eee2661975d
          type: select_option
          option: Heures Creuses
        - device_id: 1a214649b9b77e47ee787c2109d1e2e2
          domain: select
          entity_id: f6d4a900e165cafd27e94fbd4e7b3f15
          type: select_option
          option: Heures creuses
      else:
        - device_id: 1a214649b9b77e47ee787c2109d1e2e2
          domain: select
          entity_id: 476a709158fbee446d7c0eee2661975d
          type: select_option
          option: Heures pleines
        - device_id: 1a214649b9b77e47ee787c2109d1e2e2
          domain: select
          entity_id: f6d4a900e165cafd27e94fbd4e7b3f15
          type: select_option
          option: Heures pleines
  mode: single
- id: "171402400000"
  alias: Switch off all lights at midnight
  description: "Turns off all lights at midnight"
  trigger:
    - platform: time
      at: "00:00:00"
  condition: []
  action:
    - service: light.turn_off
      data:
        entity_id: all
  mode: single
